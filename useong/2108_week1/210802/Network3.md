## 이동 IP와 기타 네트워크 계층 프로토콜

### 이동 IP

**IP 터널링**

주소 표현

- 호스트 이동 시 IP 주소의 처리

1. 새로운 주소 할당: 라우팅의 처리가 수월하지만 주소 교체 작업이 필요
2. 고유의 주소 유지: 주소 교체 작업이 필요 없지만 라우팅의 처리가 복잡

에이전트

- 두 종류의 주소 사용

1. HA: 이동 호스트를 위한 고정 위치의 홈 에이전트
2. FA: 이동 호스트를 위한 가변 위치의 포린 에이전트

- 호스트가 이동할 때의 처리

1. HA는 변하지 않고 FA만 변함
2. 따라서 HA와 새로운 FA사이에 터널 설정

- 송신 호스트에서 이동 호스트까지 패킷 전달 과정

1. 먼저, 이동 호스트를 목적지로 하는 패킷은 HA에게 전달됨
2. HA는 FA와의 터널을 이용해 FA에게 패킷을 전달함
3. FA는 이동 호스트에게 패킷 전달함

IP 터널

- 터널 구간에서 IP 캡슐링 방식으로 패킷을 중개

1. 원패킷: 송신 호스트가 전송하고, 수신 호스트가 수신 받는 패킷
2. IP 캡슐 패킷: 터널 구간에서 원 패킷을 IP 캡슐화

### 기타 네트워크 계층 프로토콜

- ARP, RARP, ICMP, IGMP

**ARP(Address Resolution Protocol)**

- IP주소와 MAC 주소 사이의 변환 기능 수행

MAC 주소

- 송신 호스트의 IP 주소: 송신 호스트의 하드 디스크에서 얻을 수 있음
- 수신 호스트의 IP 주소: 사용자가 제공
- 송신 호스트의 MAC 주소: 송신 호스트의 LAN 카드에서 얻을 수 있음
- 수신 호스트의 MAC 주소: ARP 프로토콜이 제공
- ARP 프로토콜

1. 특정 호스트의 IP 주소로 부터 MAC 주소를 제공하는 프로토콜
2. ARP Request 라는 특수 패킷을 브로드 캐스팅
3. IP 주소에 해당하는 호스트만 ARP reply로 MAC 주소를 회신
4. 효율 향상을 위해 캐시 기능을 제공

**RARP(Reverse ARP)**

- 하드 디스크가 없는 시스템은 자신의 IP 주소를 알 수 없음
- 특정 호스트의 MAC 주소로 부터 IP 주소를 제공하는 프로토콜

**ICMP(Internet Control Message Protocol)**

- 인터넷 환경에서 오류에 관한 처리를 지원
- ICMP 메시지

1. ECHO Request, ECHO Reply: ping 프로그램
2. Destination UnReachable: 수신 호스트에 접근 불가능
3. Source Quench: 네트워크에 필요한 자원 부족으로 패킷 폐기
4. Time Exceeded: 시간 초과 현상으로 패킷 폐기
5. Timestamp Request, TimeStamp Reply: 네트워크 지연 측정

ICMP 헤더 형식

- 처음 8 바이트는 모든 메시지에 반드시 포함됨
- Type: 메시지를 구분
- Code: 메시지 내용에 대한 자세한 정보
- Checksum: 전체 메시지에 대한 체크섬 기능
- ICMP 메시지 내용 1: 메시지 종류에 따라 값이 결정됨
- ICMP 메시지 내용2: 오류 원인을 제공한 IP 패킷의 헤더와 이어지는 8 바이트의 정보가 포함됨

ICMP 메시지의 전송

- ICMP는 기능적으로 IP 프로토콜과 같은 계층의 역할을 수행
- ICMP 메시지는 IP 프로토콜에 캡슐화되어 전송

**IGMP(Internet Group Management Protocol)**

- 멀티캐스팅: 특정 그룹에 속한 모든 호스트에게 메시지를 전송하는 방식
- 그룹 관리

1. 그룹의 생성/제거, 그룹 참가/탈퇴
2. 멀티캐스팅을 지원하기 위한 방안

- 다중 호스트를 표시하는 멀티캐스트 그룹 주소 표기 방법의 통일

- 라우터가 멀티캐스트 주소와 이 그룹에 속하는 호스트 사이의 연관성 처리

- 효율적인 멀티캐스트 라우팅 알고리즘

- IGMP 헤더 형식

1. 임의의 호스트가 멀티캐스트 그룹에 가입하거나 탈퇴할 때 사용
2. IGMP 버전 2의 메시지 형식

- 질의 메시지: 라우트에서 호스트로 전달

- 보고 메시지: 질의 메시지에 대한 응답으로 호스트가 회신

1. Version Number [편집 오류]: 버전 2에서 사라진 필드
2. Type

- 0x11: 질의 메시지

- 0x16: 보고 메시지

- 0x17: 그룹 탈퇴에 관한 메시지

1. Max Response Time

- 질의 메시지에서 사용하며 보고 메시지가 전송되어야 하는 최대 응답 시간

1. Checksum
2. Group Address

- 질의 메시지: 0으로 채움

- 보고 메시지: 호스트가 가입을 원하는 그룹 주소 표기

- IGMP 메시지 전송

1. IGMP는 IP 프로토콜과 동등한 계층의 기능을 수행
2. IP 패킷에 캡슐화되어 전송
